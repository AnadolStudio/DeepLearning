# Demand Forecasting System (M5) ‚Äî XGBoost vs LightGBM

–ù–µ–±–æ–ª—å—à–æ–π —É—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ø–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ **¬´–ú–µ—Ç–æ–¥—ã –≥–ª—É–±–æ–∫–æ–≥–æ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è¬ª** (–≤ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–π —á–∞—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –±—É—Å—Ç–∏–Ω–≥–∏), —Ü–µ–ª—å –∫–æ—Ç–æ—Ä–æ–≥–æ ‚Äî –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ—Å—Ç—É—é —Å–∏—Å—Ç–µ–º—É –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ø—Ä–æ—Å–∞ –Ω–∞ —Ç–æ–≤–∞—Ä—ã –∏ —Å—Ä–∞–≤–Ω–∏—Ç—å –¥–≤–µ –º–æ–¥–µ–ª–∏: **XGBoost** –∏ **LightGBM**.

–ü—Ä–æ–µ–∫—Ç —Å–¥–µ–ª–∞–Ω –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç—ã–º:
- **–ê–≥—Ä–µ–≥–∞—Ü–∏—è —Å–ø—Ä–æ—Å–∞ –ø–æ —à—Ç–∞—Ç—É** (1 –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥)
- **–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ 28 –¥–Ω–µ–π –≤–ø–µ—Ä—ë–¥**
- **–û–¥–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è (holdout)** ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–µ 28 –¥–Ω–µ–π
- –ú–µ—Ç—Ä–∏–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞: **WAPE** (–∏ —Ç–æ–ª—å–∫–æ –æ–Ω–∞)
- Multi-step –ø—Ä–æ–≥–Ω–æ–∑ —á–µ—Ä–µ–∑ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é **One-Model-with-Offset** (–æ–¥–Ω–∞ –º–æ–¥–µ–ª—å –Ω–∞ –≤—Å–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç—ã + –ø—Ä–∏–∑–Ω–∞–∫ `h`)

---

## üìå –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏

**–ó–∞–¥–∞—á–∞:** —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ø—Ä–æ—Å–∞ –Ω–∞ —Ç–æ–≤–∞—Ä—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂.  
**–°–ø—Ä–æ—Å:** –ø—Ä–æ–¥–∞–∂–∏ **–≤ —à—Ç—É–∫–∞—Ö** (unit sales).  
**–¶–µ–ª—å:** —Å—Ä–∞–≤–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –º–æ–¥–µ–ª–µ–π:
- `XGBoost`
- `LightGBM`

–Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–µ **H = 28 –¥–Ω–µ–π**.

---

## üì¶ –î–∞—Ç–∞—Å–µ—Ç

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–∞—Ç–∞—Å–µ—Ç **M5 Forecasting (Walmart)**:

- `sales_train_validation.csv` ‚Äî –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–¥–∞–∂–∏
- `calendar.csv` ‚Äî –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏

–ò—Å—Ç–æ—á–Ω–∏–∫: Kaggle competition **M5 Forecasting ‚Äì Accuracy**  
(—Å–∫–∞—á–∞–π—Ç–µ –∏ –ø–æ–ª–æ–∂–∏—Ç–µ —Ñ–∞–π–ª—ã —Ä—è–¥–æ–º —Å –Ω–æ—É—Ç–±—É–∫–æ–º)

---

## üß† –ü–æ–¥—Ö–æ–¥

### 1) –ê–≥—Ä–µ–≥–∞—Ü–∏—è
–ú—ã –∞–≥—Ä–µ–≥–∏—Ä—É–µ–º –ø—Ä–æ–¥–∞–∂–∏ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —à—Ç–∞—Ç—É, –Ω–∞–ø—Ä–∏–º–µ—Ä **CA**:

> –°—É–º–º–∞ –ø—Ä–æ–¥–∞–∂ –ø–æ –≤—Å–µ–º —Ç–æ–≤–∞—Ä–∞–º –∏ –º–∞–≥–∞–∑–∏–Ω–∞–º –≤–Ω—É—Ç—Ä–∏ —à—Ç–∞—Ç–∞ ‚Üí 1 –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥ `date ‚Üí sales`.

### 2) Feature Engineering (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π)
–î–æ–±–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–∞–º—ã–µ –±–∞–∑–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, —á—Ç–æ–±—ã –Ω–µ —É—Å–ª–æ–∂–Ω—è—Ç—å —Ä–∞–±–æ—Ç—É:

**–õ–∞–≥–∏:**
- `lag_1`, `lag_7`, `lag_14`, `lag_28`

**–°–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:**
- `roll_mean_7`, `roll_mean_28`
- `roll_std_7`, `roll_std_28`

**–ö–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:**
- `wday`, `month`, `year`
- `snap_CA` (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —à—Ç–∞—Ç–∞)
- `is_event` (–µ—Å—Ç—å —Å–æ–±—ã—Ç–∏–µ/–ø—Ä–∞–∑–¥–Ω–∏–∫)

### 3) Multi-step Forecast: One-Model-with-Offset
–ú—ã –æ–±—É—á–∞–µ–º **–æ–¥–Ω—É –º–æ–¥–µ–ª—å** –Ω–∞ –≤—Å–µ —à–∞–≥–∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞, –¥–æ–±–∞–≤–ª—è—è:
- `h` ‚Äî –Ω–∞ —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –≤–ø–µ—Ä—ë–¥ –¥–µ–ª–∞–µ–º –ø—Ä–æ–≥–Ω–æ–∑ (1‚Ä¶28)

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º–æ–¥–µ–ª—å —É—á–∏—Ç—Å—è —Ä–∞–∑–ª–∏—á–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ `+1` –∏ `+28` –¥–µ–Ω—å.

---

## ‚úÖ –ú–µ—Ç—Ä–∏–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞: WAPE

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ **WAPE**:

\[
WAPE = \frac{\sum |y - \hat{y}|}{\sum |y|}
\]

–ü–æ—á–µ–º—É WAPE:
- —É—Å—Ç–æ–π—á–∏–≤–µ–µ, —á–µ–º MAPE –ø—Ä–∏ –º–∞–ª–µ–Ω—å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö
- —Ö–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–ø—Ä–æ—Å–∞ –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ –ø—Ä–æ–¥–∞–∂

---

## üß™ –í–∞–ª–∏–¥–∞—Ü–∏—è

–ü—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç (–ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é –ø—Ä–æ–µ–∫—Ç–∞):
- **train**: –≤—Å–µ –¥–Ω–∏ –∫—Ä–æ–º–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 28
- **test**: –ø–æ—Å–ª–µ–¥–Ω–∏–µ 28 –¥–Ω–µ–π
- —Å—Ç—Ä–æ–∏–º –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ 28 –¥–Ω–µ–π –∏ —Å—á–∏—Ç–∞–µ–º WAPE

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ Course_Project_M5_XGB_LGBM_CA.ipynb # –æ—Å–Ω–æ–≤–Ω–æ–π –Ω–æ—É—Ç–±—É–∫
‚îú‚îÄ‚îÄ sales_train_validation.csv # –¥–∞–Ω–Ω—ã–µ (—Å–∫–∞—á–∞—Ç—å —Å Kaggle)
‚îú‚îÄ‚îÄ calendar.csv # –¥–∞–Ω–Ω—ã–µ (—Å–∫–∞—á–∞—Ç—å —Å Kaggle)
‚îî‚îÄ‚îÄ README.md


---

## ‚ñ∂Ô∏è –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

1) –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª—ã `sales_train_validation.csv` –∏ `calendar.csv` —Å Kaggle (M5 Forecasting ‚Äì Accuracy)  
2) –ü–æ–ª–æ–∂–∏—Ç–µ –∏—Ö —Ä—è–¥–æ–º —Å –Ω–æ—É—Ç–±—É–∫–æ–º  
3) –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
4) –ó–∞–ø—É—Å–∫
